<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LoL MBTI Finder</title>
  <meta name="author" content="Mijin Yoo, Sangwoo Choi">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="images/favicon/melody.ico" type="image/x-icon">
  <link rel="stylesheet" href="stylesheet.css">

  <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
  <script>
    Kakao.init('9cc9b8181e4bb732ff409fb874ea6174');
  </script>


  <style>
    body {
      background-color: #fffdf7;
      font-family: sans-serif;
      margin: 0;
    }
    .container {
      max-width: 800px;
      margin: auto;
      padding: 40px 20px;
    }
    .question-block {
      margin-bottom: 30px;
      padding: 20px;
      background: #fef0f4;
      border-radius: 10px;
    }
    .question-title {
      font-weight: bold;
      margin-bottom: 10px;
    }
    .result {
      margin-top: 40px;
      font-size: 1.2em;
      text-align: center;
    }
    button {
      background-color: #f4c2c2;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      margin: 5px;
    }
    button:hover {
      background-color: #e8a1a1;
    }
    @media (max-width: 600px) {
      .container {
        padding: 20px 5px;
        max-width: 100%;
      }
      .question-block {
        padding: 12px;
        font-size: 1em;
      }
      .question-title {
        font-size: 1.1em;
      }
      button {
        width: 100%;
        margin: 8px 0;
        font-size: 1.1em;
      }
      #progress-bar-bg {
        height: 10px;
      }
      .result {
        font-size: 1em;
        padding: 10px 0;
      }
      img {
        max-width: 100%;
        height: auto;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1 style="text-align:center;">ğŸ® ?</h1>
    <div id="genderBlock" class="question-block">
        <div class="question-title">ì„±ë³„ì„ ì„ íƒí•˜ì„¸ìš”:</div>
        <label><input type="radio" name="gender" value="male"> ë‚¨ì„±</label><br>
        <label><input type="radio" name="gender" value="female"> ì—¬ì„±</label><br><br>
        <div style="text-align:center;">
            <button type="button" onclick="startTest()">ì‹œì‘í•˜ê¸°</button>
        </div>
    </div>

    <form id="mbtiForm" style="display: none;">
      <div id="progress-container" style="margin-bottom: 20px;">
        <div id="progress-bar-bg" style="background-color: #ffe4ec; height: 12px; border-radius: 6px; overflow: hidden;">
            <div id="progress-bar" style="width: 0%; height: 100%; background-color: #f4c2c2; transition: width 0.3s ease;"></div>
        </div>
        <div id="progress-text" style="text-align: center; margin-top: 8px;"><strong>1 / 12</strong></div>
      </div>


      <div class="question-block" id="questionBlock"></div>

      <div style="text-align:center;">
        <button type="button" id="restartBtn">ì²˜ìŒìœ¼ë¡œ</button>
        <button type="button" id="prevBtn">ì´ì „</button>
        <button type="button" id="nextBtn">ë‹¤ìŒ</button>
        <button type="submit" id="submitBtn" style="display:none;">ê²°ê³¼ ë³´ê¸°</button>
      </div>
    </form>

    <div class="result" id="resultBox"></div>
  </div>

  <script>

    function shareKakao() {
      // ì¹´ì¹´ì˜¤ SDKê°€ í•„ìš”í•©ë‹ˆë‹¤. (ì•„ë˜ ì°¸ê³ )
      if (window.Kakao && window.Kakao.isInitialized()) {
        window.Kakao.Link.sendDefault({
          objectType: 'feed',
          content: {
            title: 'ë‚˜ì˜ LoL MBTI ê²°ê³¼',
            description: `ë‚˜ëŠ” ${mbti} (${champ.name})!`,
            imageUrl: champ.image,
            link: {
              mobileWebUrl: location.href,
              webUrl: location.href
            }
          }
        });
      } else {
        alert("ì¹´ì¹´ì˜¤í†¡ ê³µìœ ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì¹´ì¹´ì˜¤ SDKê°€ í•„ìš”í•©ë‹ˆë‹¤.");
      }
    }

    function shareTwitter() {
      const text = encodeURIComponent(`ë‚˜ì˜ LoL MBTI ê²°ê³¼ëŠ” ${mbti} (${champ.name})!`);
      const url = encodeURIComponent(location.href);
      window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, "_blank");
    }

    function copyLink() {
      navigator.clipboard.writeText(location.href)
        .then(() => alert("ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!"))
        .catch(() => alert("ë³µì‚¬ ì‹¤íŒ¨!"));
    }


    const questions = [
      { name: "ei1", type: "E/I", text: "E/I ì§ˆë¬¸ ì˜ˆì‹œ 1", options: ["E", "I"] },
      { name: "ei2", type: "E/I", text: "E/I ì§ˆë¬¸ ì˜ˆì‹œ 2", options: ["E", "I"] },
      { name: "ei3", type: "E/I", text: "E/I ì§ˆë¬¸ ì˜ˆì‹œ 3", options: ["E", "I"] },
      { name: "sn1", type: "S/N", text: "S/N ì§ˆë¬¸ ì˜ˆì‹œ 1", options: ["S", "N"] },
      { name: "sn2", type: "S/N", text: "S/N ì§ˆë¬¸ ì˜ˆì‹œ 2", options: ["S", "N"] },
      { name: "sn3", type: "S/N", text: "S/N ì§ˆë¬¸ ì˜ˆì‹œ 3", options: ["S", "N"] },
      { name: "ft1", type: "F/T", text: "F/T ì§ˆë¬¸ ì˜ˆì‹œ 1", options: ["F", "T"] },
      { name: "ft2", type: "F/T", text: "F/T ì§ˆë¬¸ ì˜ˆì‹œ 2", options: ["F", "T"] },
      { name: "ft3", type: "F/T", text: "F/T ì§ˆë¬¸ ì˜ˆì‹œ 3", options: ["F", "T"] },
      { name: "pj1", type: "P/J", text: "P/J ì§ˆë¬¸ ì˜ˆì‹œ 1", options: ["P", "J"] },
      { name: "pj2", type: "P/J", text: "P/J ì§ˆë¬¸ ì˜ˆì‹œ 2", options: ["P", "J"] },
      { name: "pj3", type: "P/J", text: "P/J ì§ˆë¬¸ ì˜ˆì‹œ 3", options: ["P", "J"] }
    ];

    let currentIndex = 0;
    const answers = {};
    let gender = "";

    const questionBlock = document.getElementById("questionBlock");
    const restartBtn = document.getElementById("restartBtn");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const submitBtn = document.getElementById("submitBtn");

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
        }
    }

    shuffle(questions);  // ì§ˆë¬¸ ì„ê¸° ì‹¤í–‰

    function startTest() {
        const selected = document.querySelector('input[name="gender"]:checked');
        if (!selected) {
        alert("ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
        return;
        }
        gender = selected.value;
        document.getElementById("genderBlock").style.display = "none";
        document.getElementById("mbtiForm").style.display = "block";
        renderQuestion(currentIndex);
    }

    function renderQuestion(index) {
      const q = questions[index];
      const progressPercent = ((index + 1) / questions.length) * 100;
      document.getElementById("progress-bar").style.width = `${progressPercent}%`;
      document.getElementById("progress-text").innerHTML = `<strong>${index + 1} / ${questions.length}</strong>`;
      const selected = answers[q.name] || "";
      questionBlock.innerHTML = `
        <div class="question-title">${q.text}</div>
        ${q.options.map(opt => `
          <label>
            <input type="radio" name="${q.name}" value="${opt}" ${selected === opt ? "checked" : ""}> ${opt}
          </label><br>`).join("")}
      `;
      prevBtn.style.display = index > 0 ? "inline-block" : "none";
      nextBtn.style.display = index < questions.length - 1 ? "inline-block" : "none";
      submitBtn.style.display = index === questions.length - 1 ? "inline-block" : "none";
    }


    document.addEventListener("keydown", function(e) {
        if (e.key === "Enter") {
            const isFormVisible = document.getElementById("mbtiForm").style.display !== "none";

            if (isFormVisible && currentIndex < questions.length - 1) {
            e.preventDefault();
            nextBtn.click();  // ë‹¤ìŒ ë²„íŠ¼ ëˆ„ë¥¸ ê²ƒì²˜ëŸ¼ ë™ì‘
            }
        }
    });


    function saveAnswer() {
      const q = questions[currentIndex];
      const selected = document.querySelector(`input[name="${q.name}"]:checked`);
      if (selected) answers[q.name] = selected.value;
    }

    renderQuestion(currentIndex);

    restartBtn.onclick = () => {
        // ìƒíƒœ ì´ˆê¸°í™”
        currentIndex = 0;
        for (const key in answers) delete answers[key];
        gender = "";

        // UI ì´ˆê¸°í™”
        document.getElementById("mbtiForm").style.display = "none";
        document.getElementById("genderBlock").style.display = "block";
        document.getElementById("resultBox").innerHTML = "";

        // ë¼ë””ì˜¤ ì„ íƒ í•´ì œ
        document.querySelectorAll('input[name="gender"]').forEach(el => el.checked = false);
    };

    prevBtn.onclick = () => {
      saveAnswer();
      if (currentIndex > 0) {
        currentIndex--;
        renderQuestion(currentIndex);
      }
    };

    nextBtn.onclick = () => {
      if (!document.querySelector(`input[name="${questions[currentIndex].name}"]:checked`)) {
        alert("ë‹µë³€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
        return;
      }
      saveAnswer();
      if (currentIndex < questions.length - 1) {
        currentIndex++;
        renderQuestion(currentIndex);
      }
    };
    let mbti, champ; // ì „ì—­ ì„ ì–¸ testì¤‘

    document.getElementById("mbtiForm").onsubmit = function(e) {
      e.preventDefault();
      saveAnswer();

      const ei = [answers["ei1"], answers["ei2"], answers["ei3"]];
      const sn = [answers["sn1"], answers["sn2"], answers["sn3"]];
      const ft = [answers["ft1"], answers["ft2"], answers["ft3"]];
      const pj = [answers["pj1"], answers["pj2"], answers["pj3"]];

      function majority(arr) {
        const count = {};
        arr.forEach(v => count[v] = (count[v] || 0) + 1);
        return count[arr[0]] > 1 ? arr[0] : arr[1];
      }

      const mbti = majority(ei) + majority(sn) + majority(ft) + majority(pj);

      const champions = {
        "INTJ": {
            male: {
            name: "ì œë“œ",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Zed_0.jpg"
            },
            female: {
            name: "ë¦¬ì‚°ë“œë¼",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Lissandra_0.jpg"
            }
        },
        "INTP": {
            male: {
            name: "ë¹…í† ë¥´",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Viktor_0.jpg"
            },
            female: {
            name: "ë²¨ì½”ì¦ˆ (ì—¬ì¥ ê°€ëŠ¥)",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Velkoz_0.jpg"
            }
        },
        "ENTJ": {
            male: {
            name: "ìŠ¤ì›¨ì¸",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Swain_0.jpg"
            },
            female: {
            name: "ë ˆë„¥í†¤ (ì—¬ì¥ ë¶ˆê°€)",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Renekton_0.jpg"
            }
        },
        "ENTP": {
            male: {
            name: "ì—ì½”",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Ekko_0.jpg"
            },
            female: {
            name: "ì´ë¸”ë¦°",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Evelynn_0.jpg"
            }
        },
        "INFJ": {
            male: {
            name: "ì•¼ìŠ¤ì˜¤",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Yasuo_0.jpg"
            },
            female: {
            name: "ì¹´ë¥´ë§ˆ",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Karma_0.jpg"
            }
        },
        "INFP": {
            male: {
            name: "ë°”ë£¨ìŠ¤",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Varus_0.jpg"
            },
            female: {
            name: "ìœ ë¯¸",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Yuumi_0.jpg"
            }
        },
        "ENFJ": {
            male: {
            name: "ë¸Œë¼ì›€",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Braum_0.jpg"
            },
            female: {
            name: "ì„¸ë‚˜",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Senna_0.jpg"
            }
        },
        "ENFP": {
            male: {
            name: "ë¼ì¹¸",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Rakan_0.jpg"
            },
            female: {
            name: "ì§•í¬ìŠ¤",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Jinx_0.jpg"
            }
        },
        "ISTJ": {
            male: {
            name: "ë§íŒŒì´íŠ¸",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Malphite_0.jpg"
            },
            female: {
            name: "ì¼€ì¼",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Kayle_0.jpg"
            }
        },
        "ISFJ": {
            male: {
            name: "ëŸ¼ë¸”",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Rumble_0.jpg"
            },
            female: {
            name: "ì†Œë¼ì¹´",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Soraka_0.jpg"
            }
        },
        "ESTJ": {
            male: {
            name: "íŒí…Œì˜¨",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Pantheon_0.jpg"
            },
            female: {
            name: "ë ˆì˜¤ë‚˜",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Leona_0.jpg"
            }
        },
        "ESFJ": {
            male: {
            name: "ê°ˆë¦¬ì˜¤",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Galio_0.jpg"
            },
            female: {
            name: "ë£°ë£¨",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Lulu_0.jpg"
            }
        },
        "ISTP": {
            male: {
            name: "ê·¸ë ˆì´ë¸Œì¦ˆ",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Graves_0.jpg"
            },
            female: {
            name: "ì¹´íƒ€ë¦¬ë‚˜",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Katarina_0.jpg"
            }
        },
        "ISFP": {
            male: {
            name: "ì¼€ë„¨",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Kennen_0.jpg"
            },
            female: {
            name: "ì•„ë¦¬",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Ahri_0.jpg"
            }
        },
        "ESTP": {
            male: {
            name: "ë“œë ˆì´ë¸",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Draven_0.jpg"
            },
            female: {
            name: "ë‹ˆì½”",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Neeko_0.jpg"
            }
        },
        "ESFP": {
            male: {
            name: "ë¸Œëœë“œ",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Brand_0.jpg"
            },
            female: {
            name: "ì„¸ë¼í•€",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Seraphine_0.jpg"
            }
        },
        "default": {
            male: {
            name: "í‹°ëª¨",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Teemo_0.jpg"
            },
            female: {
            name: "í‹°ëª¨",
            image: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Teemo_0.jpg"
            }
        }
      };


      const champGroup = champions[mbti] || champions["default"];
      const champ = champGroup[gender] || champions["default"][gender];
      document.getElementById("resultBox").innerHTML =
        `
          <p><strong>${mbti}</strong> íƒ€ì…ì˜ ë‹¹ì‹ ì—ê²Œ ì–´ìš¸ë¦¬ëŠ” ì±”í”¼ì–¸ì€<br>
          <strong>${champ.name}</strong> ì…ë‹ˆë‹¤!</p>
          <img src="${champ.image}" alt="${champ.name}" style="max-width:100%; border-radius: 12px; margin-top: 20px;">
          <div style="margin-top:20px;">
            <button onclick="shareKakao()">ì¹´ì¹´ì˜¤í†¡ ê³µìœ </button>
            <button onclick="shareTwitter()">íŠ¸ìœ„í„° ê³µìœ </button>
            <button onclick="copyLink()">ë§í¬ ë³µì‚¬</button>
          </div>
        `;


    };
  </script>
</body>
</html>
